import{r}from"./iframe-DXOI1E9u.js";import{u as J}from"./useStableCallback-BG29bmz1.js";import{u as Q,a as V,F as X,I as Z}from"./InternalBackdrop-BfTmp1FM.js";import{c as $,j as A,k as ee}from"./createBaseUIEventDetails-DuvT8Jvz.js";import{u as te,a as ne,b as oe,p as se,c as re,d as ie}from"./useSyncedFloatingRootContext-DdedLQsy.js";import{u as ae}from"./useRole-hw_nALsM.js";import{u as le,a as W}from"./useInteractions-BirjbM4K.js";import{g as ce,c as ue}from"./element-C8qsRkBu.js";import{R as de,P as pe,c as x,a as N,C as O,F as ge,b as fe,t as me}from"./popupStateMapping-CpSo4hCe.js";import{f as j,u as I}from"./mergeClassName-4BJ6eZC9.js";import{t as U,u as Se}from"./useOpenChangeComplete-EYYQQ2xa.js";import{u as G}from"./useButton-gvMzLzXO.js";import{u as H}from"./useBaseUiId-DPGNyegz.js";import{C as Ce}from"./composite-CJk-2jGs.js";import{j as w}from"./jsx-runtime-u17CrQMm.js";import{i as he}from"./inertValue-210nwfDp.js";import{u as Re}from"./useClick-mxHimsfE.js";function et(e){const{store:t,parentContext:o,actionsRef:c}=e,i=t.useState("open"),s=t.useState("disablePointerDismissal"),a=t.useState("modal"),l=t.useState("popupElement"),{openMethod:n,triggerProps:d,reset:m}=Q(i);te(t);const{forceUnmount:p}=ne(i,t,()=>{m()}),u=J(C=>{const E=$(C);return E.preventUnmountOnClose=()=>{t.set("preventUnmountingOnClose",!0)},E}),f=r.useCallback(()=>{t.setOpen(!1,u(A))},[t,u]);r.useImperativeHandle(c,()=>({unmount:p,close:f}),[p,f]);const g=oe({popupStore:t,onOpenChange:t.setOpen,treatPopupAsFloatingElement:!0,noEmit:!0}),[S,h]=r.useState(0),R=S===0,M=ae(g),k=le(g,{outsidePressEvent(){return t.context.internalBackdropRef.current||t.context.backdropRef.current?"intentional":{mouse:a==="trap-focus"?"sloppy":"intentional",touch:"sloppy"}},outsidePress(C){if("button"in C&&C.button!==0||"touches"in C&&C.touches.length!==1)return!1;const E=ce(C);if(R&&!s){const D=E;return a&&(t.context.internalBackdropRef.current||t.context.backdropRef.current)?t.context.internalBackdropRef.current===D||t.context.backdropRef.current===D||ue(D,l)&&!D?.hasAttribute("data-base-ui-portal"):!0}return!1},escapeKey:R});V(i&&a===!0,l);const{getReferenceProps:y,getFloatingProps:b,getTriggerProps:v}=W([M,k]);t.useContextCallback("onNestedDialogOpen",C=>{h(C+1)}),t.useContextCallback("onNestedDialogClose",()=>{h(0)}),r.useEffect(()=>(o?.onNestedDialogOpen&&i&&o.onNestedDialogOpen(S),o?.onNestedDialogClose&&!i&&o.onNestedDialogClose(),()=>{o?.onNestedDialogClose&&i&&o.onNestedDialogClose()}),[i,o,S]);const _=r.useMemo(()=>y(d),[y,d]),T=r.useMemo(()=>v(d),[v,d]),F=r.useMemo(()=>b(),[b]);t.useSyncedValues({openMethod:n,activeTriggerProps:_,inactiveTriggerProps:T,popupProps:F,floatingRootContext:g,nestedOpenDialogCount:S})}const Ee=r.createContext(void 0);function P(e){const t=r.useContext(Ee);if(e===!1&&t===void 0)throw new Error(j(27));return t}const xe={...se,modal:x(e=>e.modal),nested:x(e=>e.nested),nestedOpenDialogCount:x(e=>e.nestedOpenDialogCount),disablePointerDismissal:x(e=>e.disablePointerDismissal),openMethod:x(e=>e.openMethod),descriptionElementId:x(e=>e.descriptionElementId),titleElementId:x(e=>e.titleElementId),viewportElement:x(e=>e.viewportElement),role:x(e=>e.role)};class tt extends de{constructor(t){super(Oe(t),{popupRef:r.createRef(),backdropRef:r.createRef(),internalBackdropRef:r.createRef(),triggerElements:new pe,onOpenChange:void 0,onOpenChangeComplete:void 0},xe)}setOpen=(t,o)=>{if(o.preventUnmountOnClose=()=>{this.set("preventUnmountingOnClose",!0)},!t&&o.trigger==null&&this.state.activeTriggerId!=null&&(o.trigger=this.state.activeTriggerElement??void 0),this.context.onOpenChange?.(t,o),o.isCanceled)return;const c={open:t,nativeEvent:o.event,reason:o.reason,nested:this.state.nested};this.state.floatingRootContext.context.events?.emit("openchange",c);const i={open:t},s=o.trigger?.id??null;(s||t)&&(i.activeTriggerId=s,i.activeTriggerElement=o.trigger??null),this.update(i)}}function Oe(e={}){return{...re(),modal:!0,disablePointerDismissal:!1,popupElement:null,viewportElement:null,descriptionElementId:void 0,titleElementId:void 0,openMethod:null,nested:!1,nestedOpenDialogCount:0,role:"dialog",...e}}const Pe={...N,...U},nt=r.forwardRef(function(t,o){const{render:c,className:i,forceRender:s=!1,...a}=t,{store:l}=P(),n=l.useState("open"),d=l.useState("nested"),m=l.useState("mounted"),p=l.useState("transitionStatus"),u=r.useMemo(()=>({open:n,transitionStatus:p}),[n,p]);return I("div",t,{state:u,ref:[l.context.backdropRef,o],stateAttributesMapping:Pe,props:[{role:"presentation",hidden:!m,style:{userSelect:"none",WebkitUserSelect:"none"}},a],enabled:s||!d})}),ot=r.forwardRef(function(t,o){const{render:c,className:i,disabled:s=!1,nativeButton:a=!0,...l}=t,{store:n}=P(),d=n.useState("open");function m(g){d&&n.setOpen(!1,$(ee,g.nativeEvent))}const{getButtonProps:p,buttonRef:u}=G({disabled:s,native:a}),f=r.useMemo(()=>({disabled:s}),[s]);return I("button",t,{state:f,ref:[o,u],props:[{onClick:m},l,p]})}),st=r.forwardRef(function(t,o){const{render:c,className:i,id:s,...a}=t,{store:l}=P(),n=H(s);return l.useSyncedValueWithCleanup("descriptionElementId",n),I("p",t,{ref:o,props:[{id:n},a]})});let ye=(function(e){return e.nestedDialogs="--nested-dialogs",e})({}),Ie=(function(e){return e[e.open=O.open]="open",e[e.closed=O.closed]="closed",e[e.startingStyle=O.startingStyle]="startingStyle",e[e.endingStyle=O.endingStyle]="endingStyle",e.nested="data-nested",e.nestedDialogOpen="data-nested-dialog-open",e})({});const L=r.createContext(void 0);function Y(){const e=r.useContext(L);if(e===void 0)throw new Error(j(26));return e}const be={...N,...U,nestedDialogOpen(e){return e?{[Ie.nestedDialogOpen]:""}:null}},rt=r.forwardRef(function(t,o){const{className:c,finalFocus:i,initialFocus:s,render:a,...l}=t,{store:n}=P(),d=n.useState("descriptionElementId"),m=n.useState("disablePointerDismissal"),p=n.useState("floatingRootContext"),u=n.useState("popupProps"),f=n.useState("modal"),g=n.useState("mounted"),S=n.useState("nested"),h=n.useState("nestedOpenDialogCount"),R=n.useState("open"),M=n.useState("openMethod"),k=n.useState("titleElementId"),y=n.useState("transitionStatus"),b=n.useState("role");Y(),Se({open:R,ref:n.context.popupRef,onComplete(){R&&n.context.onOpenChangeComplete?.(!0)}});function v(E){return E==="touch"?n.context.popupRef.current:!0}const _=s===void 0?v:s,T=h>0,F=r.useMemo(()=>({open:R,nested:S,transitionStatus:y,nestedDialogOpen:T}),[R,S,y,T]),C=I("div",t,{state:F,props:[u,{"aria-labelledby":k??void 0,"aria-describedby":d??void 0,role:b,tabIndex:-1,hidden:!g,onKeyDown(E){Ce.has(E.key)&&E.stopPropagation()},style:{[ye.nestedDialogs]:h}},l],ref:[o,n.context.popupRef,n.useStateSetter("popupElement")],stateAttributesMapping:be});return w.jsx(X,{context:p,openInteractionType:M,disabled:!g,closeOnFocusOut:!m,initialFocus:_,returnFocus:i,modal:f!==!1,restoreFocus:"popup",children:C})}),it=r.forwardRef(function(t,o){const{keepMounted:c=!1,...i}=t,{store:s}=P(),a=s.useState("mounted"),l=s.useState("modal");return a||c?w.jsx(L.Provider,{value:c,children:w.jsxs(ge,{ref:o,...i,children:[a&&l===!0&&w.jsx(Z,{ref:s.context.internalBackdropRef,inert:he(!open)}),t.children]})}):null}),at=r.forwardRef(function(t,o){const{render:c,className:i,id:s,...a}=t,{store:l}=P(),n=H(s);return l.useSyncedValueWithCleanup("titleElementId",n),I("h2",t,{ref:o,props:[{id:n},a]})}),lt=r.forwardRef(function(t,o){const{render:c,className:i,disabled:s=!1,nativeButton:a=!0,id:l,payload:n,handle:d,...m}=t,p=P(!0),u=d?.store??p?.store;if(!u)throw new Error(j(79));const f=H(l),g=u.useState("floatingRootContext"),S=u.useState("isOpenedByTrigger",f),h=r.useRef(null),{registerTrigger:R,isMountedByThisTrigger:M}=ie(f,h,u,{payload:n}),{getButtonProps:k,buttonRef:y}=G({disabled:s,native:a}),b=Re(g,{enabled:g!=null}),v=W([b]),_=r.useMemo(()=>({disabled:s,open:S}),[s,S]),T=u.useState("triggerProps",M);return I("button",t,{state:_,ref:[y,o,R,h],props:[v.getReferenceProps(),T,{[fe]:"",id:f},m,k],stateAttributesMapping:me})});let z=(function(e){return e[e.open=O.open]="open",e[e.closed=O.closed]="closed",e[e.startingStyle=O.startingStyle]="startingStyle",e[e.endingStyle=O.endingStyle]="endingStyle",e.nested="data-nested",e.nestedDialogOpen="data-nested-dialog-open",e})({});const ve={...N,...U,nested(e){return e?{[z.nested]:""}:null},nestedDialogOpen(e){return e?{[z.nestedDialogOpen]:""}:null}},ct=r.forwardRef(function(t,o){const{className:c,render:i,children:s,...a}=t,l=Y(),{store:n}=P(),d=n.useState("open"),m=n.useState("nested"),p=n.useState("transitionStatus"),u=n.useState("nestedOpenDialogCount"),f=n.useState("mounted"),g=u>0,S=r.useMemo(()=>({open:d,nested:m,transitionStatus:p,nestedDialogOpen:g}),[d,m,p,g]);return I("div",t,{enabled:l||f,state:S,ref:[o,n.useStateSetter("viewportElement")],stateAttributesMapping:ve,props:[{role:"presentation",hidden:!f,children:s},a]})}),B=new Map,q=()=>{let e=0;B.forEach(t=>{t>e&&(e=t)}),B.forEach((t,o)=>{o.style.setProperty("--dialog-max-height",`${e}px`)})},K=(e,t)=>{B.set(e,t),e.style.setProperty("--dialog-own-height",`${t}px`),q()};function ut(e){r.useEffect(()=>{if(typeof window>"u")return;const t=e.current;if(!t)return;(()=>{const i=t.getBoundingClientRect().height;Number.isFinite(i)&&K(t,i)})();let c=null;return typeof ResizeObserver<"u"&&(c=new ResizeObserver(i=>{i.forEach(s=>{if(s.target!==t)return;const a=s.borderBoxSize?.[0]?.blockSize??s.contentRect.height;Number.isFinite(a)&&K(t,a)})}),c.observe(t)),()=>{c?.disconnect(),B.delete(t),q()}},[e])}function dt(...e){return t=>{e.forEach(o=>{if(o){if(typeof o=="function"){o(t);return}o.current=t}})}}const Te="_Backdrop_103um_1",Me="_Viewport_103um_26",ke="_Popup_103um_36",_e="_Title_103um_80",De="_Description_103um_90",we="_Caption_103um_100",Be="_Content_103um_110",Fe="_Actions_103um_117",Ne="_Close_103um_125",pt={Backdrop:Te,Viewport:Me,Popup:ke,Title:_e,Description:De,Caption:we,Content:Be,Actions:Fe,Close:Ne};export{Ee as D,et as a,tt as b,lt as c,it as d,nt as e,ct as f,at as g,st as h,ot as i,ut as j,rt as k,dt as l,pt as s,P as u};
