import{r as v}from"./iframe-CbECxjq5.js";import{u as b}from"./useAnimationFrame-CwwnCJKI.js";import{u as P}from"./useTimeout-BMAPPt2Y.js";import{c as k,t as y}from"./createBaseUIEventDetails-Ca3whcAT.js";import{b as M,c as x}from"./event-CNRsvx7q.js";import{e as I}from"./element-C8qsRkBu.js";import{e as L}from"./mergeClassName-IXwn37SS.js";function Y(d,R={}){const e="rootStore"in d?d.rootStore:d,T=e.context.dataRef,{enabled:h=!0,event:a="click",toggle:g=!0,ignoreMouse:E=!1,stickIfOpen:O=!0,touchOpenDelay:n=0}=R,s=v.useRef(void 0),C=b(),p=P(),w=v.useMemo(()=>({onPointerDown(t){s.current=t.pointerType},onMouseDown(t){const r=s.current,o=t.nativeEvent,c=e.select("open");if(t.button!==0||a==="click"||M(r,!0)&&E)return;const f=T.current.openEvent,i=f?.type,m=e.select("domReferenceElement")!==t.currentTarget,l=c&&m||!(c&&g&&(!(f&&O)||i==="click"||i==="mousedown"));if(I(o.target)){const u=k(y,o,o.target);l&&r==="touch"&&n>0?p.start(n,()=>{e.setOpen(!0,u)}):e.setOpen(l,u);return}const D=t.currentTarget;C.request(()=>{const u=k(y,o,D);l&&r==="touch"&&n>0?p.start(n,()=>{e.setOpen(!0,u)}):e.setOpen(l,u)})},onClick(t){if(a==="mousedown-only")return;const r=s.current;if(a==="mousedown"&&r){s.current=void 0;return}if(M(r,!0)&&E)return;const o=e.select("open"),c=T.current.openEvent,f=e.select("domReferenceElement")!==t.currentTarget,i=o&&f||!(o&&g&&(!(c&&O)||x(c))),m=k(y,t.nativeEvent,t.currentTarget);i&&r==="touch"&&n>0?p.start(n,()=>{e.setOpen(!0,m)}):e.setOpen(i,m)},onKeyDown(){s.current=void 0}}),[T,a,E,e,O,g,C,p,n]);return v.useMemo(()=>h?{reference:w}:L,[h,w])}export{Y as u};
