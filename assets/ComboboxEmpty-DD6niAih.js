import{r as t}from"./iframe-DCTwtVEg.js";import{u as Mt}from"./useControlled-C-9u02Ss.js";import{f as je,E as Xe,d as _t,N as Ee,e as On,b as ce,a as Fn,u as he}from"./mergeClassName-CGuaxy8D.js";import{c as kt,s as ne,d as Tn,i as Hn,a as Ze,b as ut,r as Ln,f as Ot,u as Dn}from"./Listbox.module-DjVxaMRC.js";import{u as te}from"./useStableCallback-BlvU505D.js";import{v as Nn}from"./visuallyHidden-CbwUG2x5.js";import{u as jn}from"./useValueAsRef-BBKeM-2h.js";import{d as et,i as Me,e as Ne,c as N,f as Gn,n as ve,g as qn}from"./createBaseUIEventDetails-BDhVKG5E.js";import{u as $t,t as Bn}from"./useOpenChangeComplete-CAiTarFg.js";import{b as Un,u as Yt,c as zn,a as Kn,f as _n}from"./LabelableContext-Bcab7PGA.js";import{u as Wn}from"./useLabelableId-CPEzFwi8.js";import{u as Qn}from"./useTransitionStatus-BGkF8oIU.js";import{u as $n,a as Yn,I as Jn,F as Xn}from"./InternalBackdrop-Dm5KPtnK.js";import{u as ct}from"./useValueChanged-DWOD2Xr9.js";import{j as G}from"./jsx-runtime-u17CrQMm.js";import{c,S as Zn,u as i,p as eo,F as to,D as no,a as Tt}from"./popupStateMapping-D9WKduT9.js";import{u as oo,a as so}from"./useAnchorPositioning-z85Juv3n.js";import{u as ro}from"./useClick-jhZSDhhO.js";import{u as io,a as lo}from"./useInteractions-DGgngZ7b.js";import{u as ao}from"./useListNavigation-CQ0tcvfh.js";import{g as Ft,c as dt}from"./element-C8qsRkBu.js";import{i as Wt,a as uo}from"./detectBrowser-CYw91I8L.js";import{u as Jt}from"./useBaseUiId-DBEJHERS.js";import{u as co}from"./DirectionContext-gps4P05p.js";import{s as ft}from"./event-CNRsvx7q.js";import{C as fo,u as po,I as mo}from"./useCompositeListItem-DQGumxn-.js";import{i as go}from"./inertValue-B7yfhbfC.js";import{g as ho}from"./getDisabledMountTransitionStyles-CjB8mk2n.js";import{r as xo}from"./index-zOVaSaDz.js";import{u as Io}from"./useButton-BBNhskDs.js";const Xt=t.createContext(void 0),Zt=t.createContext(void 0),en=t.createContext(void 0),tn=t.createContext("");function ke(){const e=t.useContext(Xt);if(!e)throw new Error(je(22));return e}function Ht(){const e=t.useContext(Zt);if(!e)throw new Error(je(23));return e}function Ge(){const e=t.useContext(en);if(!e)throw new Error(je(24));return e}function bo(){return t.useContext(tn)}const l={id:c(e=>e.id),query:c(e=>e.query),items:c(e=>e.items),selectedValue:c(e=>e.selectedValue),open:c(e=>e.open),mounted:c(e=>e.mounted),forceMounted:c(e=>e.forceMounted),inline:c(e=>e.inline),activeIndex:c(e=>e.activeIndex),selectedIndex:c(e=>e.selectedIndex),isActive:c((e,r)=>e.activeIndex===r),isSelected:c((e,r)=>{const p=e.isItemEqualToValue,C=e.selectedValue;return Array.isArray(C)?C.some(E=>kt(E,r,p)):kt(C,r,p)}),transitionStatus:c(e=>e.transitionStatus),popupProps:c(e=>e.popupProps),inputProps:c(e=>e.inputProps),triggerProps:c(e=>e.triggerProps),getItemProps:c(e=>e.getItemProps),positionerElement:c(e=>e.positionerElement),listElement:c(e=>e.listElement),triggerElement:c(e=>e.triggerElement),inputElement:c(e=>e.inputElement),popupSide:c(e=>e.popupSide),openMethod:c(e=>e.openMethod),inputInsidePopup:c(e=>e.inputInsidePopup),selectionMode:c(e=>e.selectionMode),listRef:c(e=>e.listRef),labelsRef:c(e=>e.labelsRef),popupRef:c(e=>e.popupRef),emptyRef:c(e=>e.emptyRef),inputRef:c(e=>e.inputRef),keyboardActiveRef:c(e=>e.keyboardActiveRef),chipsContainerRef:c(e=>e.chipsContainerRef),clearRef:c(e=>e.clearRef),valuesRef:c(e=>e.valuesRef),allValuesRef:c(e=>e.allValuesRef),name:c(e=>e.name),disabled:c(e=>e.disabled),readOnly:c(e=>e.readOnly),required:c(e=>e.required),grid:c(e=>e.grid),isGrouped:c(e=>e.isGrouped),virtualized:c(e=>e.virtualized),onOpenChangeComplete:c(e=>e.onOpenChangeComplete),openOnInputClick:c(e=>e.openOnInputClick),itemToStringLabel:c(e=>e.itemToStringLabel),isItemEqualToValue:c(e=>e.isItemEqualToValue),modal:c(e=>e.modal),autoHighlight:c(e=>e.autoHighlight),submitOnItemClick:c(e=>e.submitOnItemClick)};function Co(e,r){return(p,C)=>{if(p==null)return!1;const E=ne(p,r);return e.contains(E,C)}}function vo(e,r,p){return(C,E)=>{if(C==null)return!1;if(!E)return!0;const m=ne(C,r),g=p!=null?ne(p,r):"";return g&&e.contains(g,E)&&g.length===E.length?!0:e.contains(m,E)}}const Qt=new Map;function nn(e){return Array.isArray(e)?e.map(r=>nn(r)).join(","):e==null?"":String(e)}function yo(e={}){const r={usage:"search",sensitivity:"base",ignorePunctuation:!0,...e},p=`${nn(e.locale)}|${JSON.stringify(r)}`,C=Qt.get(p);if(C)return C;const E=new Intl.Collator(e.locale,r),m={contains(g,d,o){if(!d)return!0;const R=ne(g,o);for(let w=0;w<=R.length-d.length;w+=1)if(E.compare(R.slice(w,w+d.length),d)===0)return!0;return!1},startsWith(g,d,o){if(!d)return!0;const R=ne(g,o);return E.compare(R.slice(0,d.length),d)===0},endsWith(g,d,o){if(!d)return!0;const R=ne(g,o),w=d.length;return R.length>=w&&E.compare(R.slice(R.length-w),d)===0}};return Qt.set(p,m),m}const Ro=yo,on=Symbol("none"),De={value:on,index:-1};function ds(e){const{id:r,onOpenChangeComplete:p,defaultSelectedValue:C=null,selectedValue:E,onSelectedValueChange:m,defaultInputValue:g,inputValue:d,selectionMode:o="none",onItemHighlighted:R,name:w,disabled:q=!1,readOnly:F=!1,required:h=!1,inputRef:se,grid:M=!1,items:y,filteredItems:W,filter:n,openOnInputClick:Q=!0,autoHighlight:X=!1,keepHighlight:de=!1,highlightItemOnHover:T=!0,itemToStringLabel:x,itemToStringValue:P,isItemEqualToValue:L=Tn,virtualized:K=!1,inline:$=!1,fillInputOnItemPress:xe=!0,modal:B=!1,limit:D=-1,autoComplete:v="list",locale:H,submitOnItemClick:fe=!1}=e,{clearErrors:Ve}=Un(),{setDirty:oe,validityData:re,shouldValidateOnChange:z,setFilled:Se,name:_e,disabled:k,validation:A}=Yt(),we=Wn({id:r}),qe=Ro({locale:H}),[ye,We]=t.useState(!1),[a,V]=t.useState(null),_=t.useRef([]),ie=t.useRef([]),pe=t.useRef(null),S=t.useRef(null),Ie=t.useRef(null),Oe=t.useRef(!0),Lt=t.useRef(!1),Dt=t.useRef(null),Nt=t.useRef(null),mt=t.useRef(null),be=t.useRef(De),gt=t.useRef(null),Be=t.useRef([]),jt=t.useRef([]),Fe=k||q,Ce=_e??w,Y=o==="multiple",me=o==="single",Ue=d!==void 0||g!==void 0,ze=y!==void 0,ht=W!==void 0;let Z;X==="always"?Z="always":Z=X?"input-change":!1;const[f,tt]=Mt({controlled:E,default:Y?C??Xe:C,name:"Combobox",state:"selectedValue"}),nt=t.useMemo(()=>n===null?()=>!0:n!==void 0?n:me&&!ye?vo(qe,x,f):Co(qe,x),[n,me,f,ye,qe,x]),Gt=_t(()=>Ue?g??"":me?ne(f,x):"").current,[le,dn]=Mt({controlled:d,default:Gt,name:"Combobox",state:"inputValue"}),[U,fn]=Mt({controlled:e.open,default:e.defaultOpen,name:"Combobox",state:"open"}),Re=Hn(y),ee=a??(le===""?"":String(le).trim()),xt=me?ne(f,x):"",qt=me&&!ye&&ee!==""&&xt!==""&&xt.length===ee.length&&qe.contains(xt,ee),Qe=qt?"":ee,Bt=ze&&ht&&qt,Ae=t.useMemo(()=>y?Re?y.flatMap(s=>s.items):y:Xe,[y,Re]),$e=t.useMemo(()=>{if(W&&!Bt)return W;if(!y)return Xe;if(Re){const u=y,I=[];let O=0;for(const j of u){if(D>-1&&O>=D)break;const J=Qe===""?j.items:j.items.filter(at=>nt(at,Qe,x));if(J.length===0)continue;const He=D>-1?D-O:1/0,Le=J.slice(0,He);if(Le.length>0){const at={...j,items:Le};I.push(at),O+=Le.length}}return I}if(Qe==="")return D>-1?Ae.slice(0,D):Ae;const s=[];for(const u of Ae){if(D>-1&&s.length>=D)break;nt(u,Qe,x)&&s.push(u)}return s},[W,Bt,y,Re,Qe,D,nt,x,Ae]),ge=t.useMemo(()=>Re?$e.flatMap(u=>u.items):$e,[$e,Re]),b=_t(()=>new Zn({id:we,selectedValue:f,open:U,filter:nt,query:ee,items:y,selectionMode:o,listRef:_,labelsRef:ie,popupRef:pe,emptyRef:Ie,inputRef:S,keyboardActiveRef:Oe,chipsContainerRef:Dt,clearRef:Nt,valuesRef:Be,allValuesRef:jt,selectionEventRef:mt,name:Ce,disabled:Fe,readOnly:F,required:h,grid:M,isGrouped:Re,virtualized:K,openOnInputClick:Q,itemToStringLabel:x,isItemEqualToValue:L,modal:B,autoHighlight:Z,submitOnItemClick:fe,hasInputValue:Ue,mounted:!1,forceMounted:!1,transitionStatus:"idle",inline:$,activeIndex:null,selectedIndex:null,popupProps:{},inputProps:{},triggerProps:{},positionerElement:null,listElement:null,triggerElement:null,inputElement:null,popupSide:null,openMethod:null,inputInsidePopup:!0,onOpenChangeComplete:p||Ee,setOpen:Ee,setInputValue:Ee,setSelectedValue:Ee,setIndices:Ee,onItemHighlighted:Ee,handleSelection:Ee,getItemProps:()=>On,forceMount:Ee,requestSubmit:Ee})).current,Ke=o==="none"?le:f,pn=t.useMemo(()=>o==="none"?Ke:Array.isArray(f)?f.map(s=>Ze(s,P)):Ze(f,P),[Ke,P,o,f]),It=te(R),bt=te(p),ot=i(b,l.activeIndex),mn=i(b,l.selectedIndex),st=i(b,l.positionerElement),Ut=i(b,l.listElement),Ye=i(b,l.triggerElement),Ct=i(b,l.inputElement),Pe=i(b,l.inline),Te=i(b,l.inputInsidePopup),gn=jn(Ye),{mounted:zt,setMounted:hn,transitionStatus:vt}=Qn(U),{openMethod:Kt,triggerProps:yt,reset:xn}=$n(U);zn({id:we,name:Ce,commit:A.commit,value:Ke,controlRef:Te?gn:S,getValue:()=>pn});const rt=te(()=>{y?ie.current=ge.map(s=>ne(s,x)):b.set("forceMounted",!0)}),In=t.useRef(f);ce(()=>{f!==In.current&&rt()},[rt,f]);const ae=te(s=>{b.update(s);const u=s.type||"none";if(s.activeIndex!==void 0)if(s.activeIndex===null)be.current!==De&&(be.current=De,It(void 0,et(u,void 0,{index:-1})));else{const I=Be.current[s.activeIndex];be.current={value:I,index:s.activeIndex},It(I,et(u,void 0,{index:s.activeIndex}))}}),ue=te((s,u)=>{if(Lt.current=u.reason===Me,e.onInputValueChange?.(s,u),!u.isCanceled){if(u.reason===Ne){const I=s.trim()!=="";I&&We(!0),gt.current={hasQuery:I},I&&Z&&b.state.activeIndex==null&&b.set("activeIndex",0)}dn(s)}}),Je=te((s,u)=>{U!==s&&(u.reason==="escape-key"&&ze&&ge.length===0&&!b.state.emptyRef.current&&u.allowPropagation(),e.onOpenChange?.(s,u),!u.isCanceled&&(!s&&ye&&(me?(V(ee),ee===""&&We(!1)):Y&&(Pe||Te?ae({activeIndex:null}):V(ee),ue("",N(Me,u.event)))),fn(s)))}),it=te((s,u)=>{if(m?.(s,u),u.isCanceled)return;tt(s),(o==="none"&&pe.current&&xe||me&&!b.state.inputInsidePopup)&&ue(ne(s,x),N(u.reason,u.event)),me&&s!=null&&u.reason!==Ne&&ye&&V(ee)}),bn=te((s,u)=>{let I=u;if(I===void 0){if(ot===null)return;I=Be.current[ot]}const O=Ft(s),j=mt.current??s;mt.current=null;const J=N(Gn,j),He=O?.closest("a")?.getAttribute("href");if(He){He.startsWith("#")&&Je(!1,J);return}if(Y){const Le=Array.isArray(f)?f:[],kn=ut(Le,I,b.state.isItemEqualToValue)?Ln(Le,I,b.state.isItemEqualToValue):[...Le,I];if(it(kn,J),!(S.current?S.current.value.trim()!=="":!1))return;b.state.inputInsidePopup?ue("",N(Me,J.event)):Je(!1,J)}else it(I,J),Je(!1,J)}),Rt=te(()=>{if(!b.state.submitOnItemClick)return;const s=b.state.inputElement?.form;s&&typeof s.requestSubmit=="function"&&s.requestSubmit()}),Pt=te(()=>{if(hn(!1),bt?.(!1),We(!1),xn(),V(null),ae(o==="none"?{activeIndex:null,selectedIndex:null}:{activeIndex:null}),Y&&S.current&&S.current.value!==""&&!Lt.current&&ue("",N(Me)),me)if(b.state.inputInsidePopup)S.current&&S.current.value!==""&&ue("",N(Me));else{const s=ne(f,x);S.current&&S.current.value!==s&&ue(s,N(s===""?Me:ve))}}),Cn=t.useMemo(()=>Pe&&st?{current:st.closest('[role="dialog"]')}:pe,[Pe,st]);$t({enabled:!e.actionsRef,open:U,ref:Cn,onComplete(){U||Pt()}}),t.useImperativeHandle(e.actionsRef,()=>({unmount:Pt}),[Pt]),ce(function(){if(U||o==="none")return;const u=y?Ae:jt.current;if(Y){const I=Array.isArray(f)?f:[],O=I[I.length-1],j=Ot(u,O,L);ae({selectedIndex:j===-1?null:j})}else{const I=Ot(u,f,L);ae({selectedIndex:I===-1?null:I})}},[U,f,y,o,Ae,Y,L,ae]),ce(()=>{y&&(Be.current=ge,_.current.length=ge.length)},[y,ge]),ce(()=>{const s=gt.current;if(s&&(s.hasQuery?Z&&b.set("activeIndex",0):Z==="always"&&b.set("activeIndex",0),gt.current=null),!U&&!Pe)return;const I=ze||ht?ge:Be.current,O=b.state.activeIndex;if(O==null){if(Z==="always"&&I.length>0){b.set("activeIndex",0);return}be.current!==De&&(be.current=De,b.state.onItemHighlighted(void 0,et(ve,void 0,{index:-1})));return}if(O>=I.length){be.current!==De&&(be.current=De,b.state.onItemHighlighted(void 0,et(ve,void 0,{index:-1}))),b.set("activeIndex",null);return}const j=I[O],J=be.current.value,He=J!==on&&b.state.isItemEqualToValue(j,J);(be.current.index!==O||!He)&&(be.current={value:j,index:O},b.state.onItemHighlighted(j,et(ve,void 0,{index:O})))},[ot,Z,ht,ze,ge,Pe,U,b]),ce(()=>{if(!y||o==="none")return;const s=Ae;if(Y){const O=Array.isArray(f)?f:Xe,j=O.filter(J=>ut(s,J,b.state.isItemEqualToValue));j.length!==O.length&&tt(j);return}if(f==null?!0:ut(s,f,b.state.isItemEqualToValue))return;let I=null;if(C!=null&&ut(s,C,b.state.isItemEqualToValue)&&(I=C),tt(I),!b.state.inputInsidePopup){const O=ne(I,x);S.current&&S.current.value!==O&&ue(O,N(ve))}},[y,Ae,Y,o,f,C,tt,x,b,ue]),ce(()=>{if(o==="none"){Se(String(le)!=="");return}Se(Y?Array.isArray(f)&&f.length>0:f!=null)},[Se,o,le,f,Y]),t.useEffect(()=>{ze&&Z&&ge.length===0&&ae({activeIndex:null})},[ze,Z,ge.length,ae]),ct(ee,()=>{!U||ee===""||ee===String(Gt)||We(!0)}),ct(f,()=>{if(o!=="none"&&(Ve(Ce),oe(f!==re.initialValue),z()?A.commit(f):A.commit(f,!0),Y&&b.state.selectedIndex!==null&&(!Array.isArray(f)||f.length===0)&&ae({activeIndex:null,selectedIndex:null}),me&&!Ue&&!Te)){const s=ne(f,x);le!==s&&ue(s,N(ve))}}),ct(le,()=>{o==="none"&&(Ve(Ce),oe(le!==re.initialValue),z()?A.commit(le):A.commit(le,!0))}),ct(y,()=>{if(!me||Ue||Te||ye)return;const s=ne(f,x);le!==s&&ue(s,N(ve))});const lt=oo({open:Pe?!0:U,onOpenChange:Je,elements:{reference:Te?Ye:Ct,floating:st}});let Et,Vt;Pe||(Et=M?"grid":"listbox",Vt=U?"true":"false");const vn=t.useMemo(()=>{const s=Ct?.tagName==="INPUT",u=s||U,I=s?{autoComplete:"off",spellCheck:"false",autoCorrect:"off",autoCapitalize:"none"}:{};return u&&(I.role="combobox",I["aria-expanded"]=Vt,I["aria-haspopup"]=Et,I["aria-controls"]=U?Ut?.id:void 0,I["aria-autocomplete"]=v),{reference:I,floating:{role:"presentation"}}},[Ct,U,Vt,Et,Ut?.id,v]),yn=ro(lt,{enabled:!F&&!Fe&&Q,event:"mousedown-only",toggle:!1,touchOpenDelay:Te?0:50}),Rn=io(lt,{enabled:!F&&!Fe&&!Pe,outsidePressEvent:{mouse:"sloppy",touch:"intentional"},bubbles:Pe?!0:void 0,outsidePress(s){const u=Ft(s);return!dt(Ye,u)&&!dt(Nt.current,u)&&!dt(Dt.current,u)}}),Pn=ao(lt,{enabled:!F&&!Fe,id:we,listRef:_,activeIndex:ot,selectedIndex:mn,virtual:!0,loopFocus:!0,allowEscape:!Z,focusItemOnOpen:ye||o==="none"&&!Z?!1:"auto",focusItemOnHover:T,resetOnPointerLeave:!de,cols:M?2:1,orientation:M?"horizontal":void 0,disabledIndices:Xe,onNavigate(s,u){!u&&!U||vt==="ending"||ae(u?{activeIndex:s,type:Oe.current?"keyboard":"pointer"}:{activeIndex:s})}}),{getReferenceProps:St,getFloatingProps:wt,getItemProps:At}=lo([vn,yn,Rn,Pn]);Dn(()=>{b.update({inline:$,popupProps:wt(),inputProps:St(),triggerProps:yt,getItemProps:At,setOpen:Je,setInputValue:ue,setSelectedValue:it,setIndices:ae,onItemHighlighted:It,handleSelection:bn,forceMount:rt,requestSubmit:Rt})}),ce(()=>{b.update({id:we,selectedValue:f,open:U,mounted:zt,transitionStatus:vt,items:y,inline:$,popupProps:wt(),inputProps:St(),triggerProps:yt,openMethod:Kt,getItemProps:At,selectionMode:o,name:Ce,disabled:Fe,readOnly:F,required:h,grid:M,isGrouped:Re,virtualized:K,onOpenChangeComplete:bt,openOnInputClick:Q,itemToStringLabel:x,modal:B,autoHighlight:Z,isItemEqualToValue:L,submitOnItemClick:fe,hasInputValue:Ue,requestSubmit:Rt})},[b,we,f,U,zt,vt,y,wt,St,At,Kt,yt,o,Ce,Fe,F,h,A,M,Re,K,bt,Q,x,B,L,fe,Ue,$,Rt,Z]);const En=Fn(se,A.inputRef),Vn=t.useMemo(()=>({query:ee,filteredItems:$e,flatFilteredItems:ge}),[ee,$e,ge]),Sn=t.useMemo(()=>Array.isArray(Ke)?"":Ze(Ke,P),[Ke,P]),wn=Y&&Array.isArray(f)&&f.length>0,An=t.useMemo(()=>!Y||!Array.isArray(f)||!Ce?null:f.map(s=>{const u=Ze(s,P);return G.jsx("input",{type:"hidden",name:Ce,value:u},u)}),[Y,f,Ce,P]),Mn=G.jsxs(t.Fragment,{children:[e.children,G.jsx("input",{...A.getInputValidationProps({onFocus(){if(Te){Ye?.focus();return}(S.current||Ye)?.focus()},onChange(s){if(s.nativeEvent.defaultPrevented)return;const u=s.target.value,I=N(Ne,s.nativeEvent);function O(){if(Y)return;if(o==="none"){oe(u!==re.initialValue),ue(u,I),z()&&A.commit(u);return}const j=Be.current.find(J=>Ze(J,P).toLowerCase()===u.toLowerCase());j!=null&&(oe(j!==re.initialValue),it?.(j,I),z()&&A.commit(j))}y?O():(rt(),queueMicrotask(O))}}),id:we,name:Y||o==="none"?void 0:Ce,disabled:Fe,required:h&&!wn,readOnly:F,value:Sn,ref:En,style:Nn,tabIndex:-1,"aria-hidden":!0}),An]});return G.jsx(Xt.Provider,{value:b,children:G.jsx(Zt.Provider,{value:lt,children:G.jsx(en.Provider,{value:Vn,children:G.jsx(tn.Provider,{value:le,children:Mn})})})})}const Po=t.createContext(void 0);function Eo(){return t.useContext(Po)}const sn=t.createContext(void 0);function pt(e){const r=t.useContext(sn);if(r===void 0&&!e)throw new Error(je(21));return r}const Vo={...eo,..._n,popupSide:e=>e?{"data-popup-side":e}:null,listEmpty:e=>e?{"data-list-empty":""}:null},fs=t.forwardRef(function(r,p){const{render:C,className:E,disabled:m=!1,id:g,...d}=r,{state:o,disabled:R,setTouched:w,setFocused:q,validationMode:F,validation:h}=Yt(),{labelId:se}=Kn(),M=Eo(),W=!!pt(!0),n=ke(),{filteredItems:Q}=Ge(),X=bo(),de=Jt(g),T=co(),x=i(n,l.disabled),P=i(n,l.readOnly),L=i(n,l.name),K=i(n,l.selectionMode),$=i(n,l.autoHighlight),xe=i(n,l.inputProps),B=i(n,l.triggerProps),D=i(n,l.open),v=i(n,l.mounted),H=i(n,l.selectedValue),fe=i(n,l.popupSide),Ve=i(n,l.positionerElement),oe=!!$,re=v&&Ve?fe:null,z=R||x||m,Se=Q.length===0,[_e,k]=t.useState(null),A=t.useRef(!1),we=te(a=>{const V=W||n.state.inline;V&&!n.state.hasInputValue&&n.state.setInputValue("",N(ve)),n.update({inputElement:a,inputInsidePopup:V})}),qe=t.useMemo(()=>({...o,open:D,disabled:z,readOnly:P,popupSide:re,listEmpty:Se}),[o,D,z,P,re,Se]);function ye(a){if(!M)return;let V;const{highlightedChipIndex:_}=M;if(_!==void 0){if(a.key==="ArrowLeft")a.preventDefault(),_>0?V=_-1:V=void 0;else if(a.key==="ArrowRight")a.preventDefault(),_<H.length-1?V=_+1:V=void 0;else if(a.key==="Backspace"||a.key==="Delete"){a.preventDefault();const ie=_>=H.length-1?H.length-2:_;V=ie>=0?ie:void 0,n.state.setIndices({activeIndex:null,selectedIndex:null,type:"keyboard"})}return V}return a.key==="ArrowLeft"&&(a.currentTarget.selectionStart??0)===0&&H.length>0?(a.preventDefault(),V=Math.max(H.length-1,0)):a.key==="Backspace"&&a.currentTarget.value===""&&H.length>0&&(n.state.setIndices({activeIndex:null,selectedIndex:null,type:"keyboard"}),a.preventDefault()),V}return he("input",r,{state:qe,ref:[p,n.state.inputRef,we],props:[xe,B,{type:"text",value:r.value??_e??X,"aria-readonly":P||void 0,"aria-labelledby":se,disabled:z,readOnly:P,...K==="none"&&L&&{name:L},id:de,onFocus(){q(!0)},onBlur(){if(w(!0),q(!1),F==="onBlur"){const a=K==="none"?X:H;h.commit(a)}},onCompositionStart(a){uo||(A.current=!0,k(a.currentTarget.value))},onCompositionEnd(a){A.current=!1;const V=a.currentTarget.value;k(null),n.state.setInputValue(V,N(Ne,a.nativeEvent))},onChange(a){if(A.current){const pe=a.currentTarget.value;k(pe),pe===""&&!n.state.openOnInputClick&&!n.state.inputInsidePopup&&n.state.setOpen(!1,N(Me,a.nativeEvent));const S=pe.trim(),Ie=oe&&S!=="";!P&&!z&&S!==""&&(n.state.setOpen(!0,N(Ne,a.nativeEvent)),oe||n.state.setIndices({activeIndex:null,selectedIndex:null,type:n.state.keyboardActiveRef.current?"keyboard":"pointer"})),D&&n.state.activeIndex!==null&&!Ie&&n.state.setIndices({activeIndex:null,selectedIndex:null,type:n.state.keyboardActiveRef.current?"keyboard":"pointer"});return}n.state.setInputValue(a.currentTarget.value,N(Ne,a.nativeEvent));const V=a.currentTarget.value==="",_=N(Me,a.nativeEvent);V&&!n.state.inputInsidePopup&&(K==="single"&&n.state.setSelectedValue(null,_),n.state.openOnInputClick||n.state.setOpen(!1,_));const ie=a.currentTarget.value.trim();!P&&!z&&ie!==""&&(n.state.setOpen(!0,N(Ne,a.nativeEvent)),oe||n.state.setIndices({activeIndex:null,selectedIndex:null,type:n.state.keyboardActiveRef.current?"keyboard":"pointer"})),D&&n.state.activeIndex!==null&&!oe&&n.state.setIndices({activeIndex:null,selectedIndex:null,type:n.state.keyboardActiveRef.current?"keyboard":"pointer"})},onKeyDown(a){if(z||P||a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)return;n.state.keyboardActiveRef.current=!0;const V=a.currentTarget,_=V.scrollWidth-V.clientWidth,ie=T==="rtl";if(a.key==="Home"){ft(a);const S=Wt&&ie?V.value.length:0;V.setSelectionRange(S,S),V.scrollLeft=0;return}if(a.key==="End"){ft(a);const S=Wt&&ie?0:V.value.length;V.setSelectionRange(S,S),V.scrollLeft=ie?-_:_;return}if(!v&&a.key==="Escape"){const S=K==="multiple"&&Array.isArray(H)?H.length===0:H===null,Ie=N(qn,a.nativeEvent),Oe=K==="multiple"?[]:null;n.state.setInputValue("",Ie),n.state.setSelectedValue(Oe,Ie),!S&&!n.state.inline&&!Ie.isPropagationAllowed&&a.stopPropagation();return}if(M&&a.key==="Backspace"&&V.value===""&&M.highlightedChipIndex===void 0&&Array.isArray(H)&&H.length>0){const S=H.slice(0,-1);n.state.setIndices({activeIndex:null,selectedIndex:null,type:n.state.keyboardActiveRef.current?"keyboard":"pointer"}),n.state.setSelectedValue(S,N(ve,a.nativeEvent));return}const pe=ye(a);if(M?.setHighlightedChipIndex(pe),pe!==void 0?M?.chipsRef.current[pe]?.focus():n.state.inputRef.current?.focus(),a.which!==229&&a.key==="Enter"&&D){const S=n.state.activeIndex,Ie=a.nativeEvent;if(S===null){n.state.setOpen(!1,N(ve,Ie));return}ft(a);const Oe=n.state.listRef.current[S];Oe&&(n.state.selectionEventRef.current=Ie,Oe.click(),n.state.selectionEventRef.current=null)}},onPointerMove(){n.state.keyboardActiveRef.current=!1},onPointerDown(){n.state.keyboardActiveRef.current=!1}},h?h.getValidationProps(d):d],stateAttributesMapping:Vo})}),rn=t.createContext(null);function So(){return t.useContext(rn)}function wo(e){const{children:r,items:p}=e,C=t.useMemo(()=>({items:p}),[p]);return G.jsx(rn.Provider,{value:C,children:r})}function Ao(e){const{children:r}=e,{filteredItems:p}=Ge(),C=So(),E=C?C.items:p;return E?G.jsx(t.Fragment,{children:E.map(r)}):null}const ps=t.forwardRef(function(r,p){var C;const{render:E,className:m,children:g,...d}=r,o=ke(),R=Ht(),w=!!pt(!0),{filteredItems:q}=Ge(),F=i(o,l.items),h=i(o,l.labelsRef),se=i(o,l.listRef),M=i(o,l.selectionMode),y=i(o,l.grid),W=i(o,l.popupProps),n=i(o,l.disabled),Q=i(o,l.readOnly),X=i(o,l.virtualized),de=M==="multiple",T=q.length===0,x=te(B=>{o.set("positionerElement",B)}),P=te(B=>{o.set("listElement",B)}),L=t.useMemo(()=>typeof g=="function"?C||(C=G.jsx(Ao,{children:g})):g,[g]),K=t.useMemo(()=>({empty:T}),[T]),$=R.useState("floatingId"),xe=he("div",r,{state:K,ref:[p,P,w?null:x],props:[W,{children:L,tabIndex:-1,id:$,role:y?"grid":"listbox","aria-multiselectable":de?"true":void 0,onKeyDown(B){if(!(n||Q)&&B.key==="Enter"){const D=o.state.activeIndex;if(D==null)return;ft(B);const v=B.nativeEvent,H=o.state.listRef.current[D];H&&(o.state.selectionEventRef.current=v,H.click(),o.state.selectionEventRef.current=null)}},onKeyDownCapture(){o.state.keyboardActiveRef.current=!0},onPointerMoveCapture(){o.state.keyboardActiveRef.current=!1}},d]});return X?xe:G.jsx(fo,{elementsRef:se,labelsRef:F?void 0:h,children:xe})}),ms=t.forwardRef(function(r,p){const{render:C,className:E,...m}=r;return he("div",r,{ref:p,props:[{role:"status","aria-live":"polite","aria-atomic":!0},m]})}),ln=t.createContext(void 0);function Mo(){const e=t.useContext(ln);if(e===void 0)throw new Error(je(20));return e}const gs=t.forwardRef(function(r,p){const{keepMounted:C=!1,...E}=r,m=ke(),g=i(m,l.mounted),d=i(m,l.forceMounted);return g||C||d?G.jsx(ln.Provider,{value:C,children:G.jsx(to,{ref:p,...E})}):null}),hs=t.forwardRef(function(r,p){const{render:C,className:E,anchor:m,positionMethod:g="absolute",side:d="bottom",align:o="center",sideOffset:R=0,alignOffset:w=0,collisionBoundary:q="clipping-ancestors",collisionPadding:F=5,arrowPadding:h=5,sticky:se=!1,disableAnchorTracking:M=!1,collisionAvoidance:y=no,...W}=r,n=ke(),{filteredItems:Q}=Ge(),X=Ht(),de=Mo(),T=i(n,l.modal),x=i(n,l.open),P=i(n,l.mounted),L=i(n,l.openMethod),K=i(n,l.triggerElement),$=i(n,l.inputElement),xe=i(n,l.inputInsidePopup),B=Q.length===0,v=so({anchor:m??(xe?K:$),floatingRootContext:X,positionMethod:g,mounted:P,side:d,sideOffset:R,align:o,alignOffset:w,arrowPadding:h,collisionBoundary:q,collisionPadding:F,sticky:se,disableAnchorTracking:M,keepMounted:de,collisionAvoidance:y,lazyFlip:!0});Yn(x&&T&&L!=="touch",K);const H=t.useMemo(()=>{const z={...v.positionerStyles};return x||(z.pointerEvents="none"),{role:"presentation",hidden:!P,style:z}},[x,P,v.positionerStyles]),fe=t.useMemo(()=>({open:x,side:v.side,align:v.align,anchorHidden:v.anchorHidden,empty:B}),[x,v.side,v.align,v.anchorHidden,B]);ce(()=>{n.set("popupSide",v.side)},[n,v.side]);const Ve=t.useMemo(()=>({side:v.side,align:v.align,arrowRef:v.arrowRef,arrowUncentered:v.arrowUncentered,arrowStyles:v.arrowStyles,anchorHidden:v.anchorHidden,isPositioned:v.isPositioned}),[v.side,v.align,v.arrowRef,v.arrowUncentered,v.arrowStyles,v.anchorHidden,v.isPositioned]),oe=te(z=>{n.set("positionerElement",z)}),re=he("div",r,{state:fe,ref:[p,oe],props:[H,W],stateAttributesMapping:Tt});return G.jsxs(sn.Provider,{value:Ve,children:[P&&T&&G.jsx(Jn,{inert:go(!x),cutout:$??K}),re]})}),ko={...Tt,...Bn},xs=t.forwardRef(function(r,p){const{render:C,className:E,initialFocus:m,finalFocus:g,...d}=r,o=ke(),R=pt(),w=Ht(),{filteredItems:q}=Ge(),F=i(o,l.mounted),h=i(o,l.open),se=i(o,l.openMethod),M=i(o,l.transitionStatus),y=i(o,l.inputInsidePopup),W=i(o,l.inputElement),n=q.length===0;$t({open:h,ref:o.state.popupRef,onComplete(){h&&o.state.onOpenChangeComplete(!0)}});const Q=t.useMemo(()=>({open:h,side:R.side,align:R.align,anchorHidden:R.anchorHidden,transitionStatus:M,empty:n}),[h,R.side,R.align,R.anchorHidden,M,n]),X=he("div",r,{state:Q,ref:[p,o.state.popupRef],props:[{role:y?"dialog":"presentation",tabIndex:-1,onFocus(P){const L=Ft(P.nativeEvent);se!=="touch"&&(dt(o.state.listElement,L)||L===P.currentTarget)&&o.state.inputRef.current?.focus()}},ho(M),d],stateAttributesMapping:ko}),T=m===void 0?y?P=>P==="touch"?o.state.popupRef.current:W:!1:m;let x;return g!=null?x=g:x=y?void 0:!1,G.jsx(Xn,{context:w,disabled:!F,modal:!y,openInteractionType:se,initialFocus:T,returnFocus:x,children:X})}),Is=t.forwardRef(function(r,p){const{className:C,render:E,...m}=r,g=ke(),{arrowRef:d,side:o,align:R,arrowUncentered:w,arrowStyles:q}=pt(),F=i(g,l.open),h=t.useMemo(()=>({open:F,side:o,align:R,uncentered:w}),[F,o,R,w]);return he("div",r,{ref:[d,p],stateAttributesMapping:Tt,state:h,props:{style:q,"aria-hidden":!0,...m}})}),an=t.createContext(void 0);function Oo(){const e=t.useContext(an);if(e===void 0)throw new Error(je(18));return e}const bs=t.forwardRef(function(r,p){const{render:C,className:E,items:m,...g}=r,[d,o]=t.useState(),R=t.useMemo(()=>({labelId:d,setLabelId:o,items:m}),[d,o,m]),w=he("div",r,{ref:p,props:[{role:"group","aria-labelledby":d},g]}),q=G.jsx(an.Provider,{value:R,children:w});return m?G.jsx(wo,{items:m,children:q}):q}),Cs=t.forwardRef(function(r,p){const{render:C,className:E,id:m,...g}=r,{setLabelId:d}=Oo(),o=Jt(m);return ce(()=>(d(o),()=>{d(void 0)}),[o,d]),he("div",r,{ref:p,props:[{id:o},g]})}),un=t.createContext(void 0);function vs(){const e=t.useContext(un);if(!e)throw new Error(je(19));return e}const cn=t.createContext(!1);function Fo(){return t.useContext(cn)}const ys=t.memo(t.forwardRef(function(r,p){const{render:C,className:E,value:m=null,index:g,disabled:d=!1,nativeButton:o=!1,...R}=r,w=t.useRef(!1),q=t.useRef(null),F=po({index:g,textRef:q,indexGuessBehavior:mo.GuessFromOrder}),h=ke(),se=Fo(),{flatFilteredItems:M}=Ge(),y=i(h,l.open),W=i(h,l.selectionMode),n=i(h,l.readOnly),Q=i(h,l.virtualized),X=i(h,l.isItemEqualToValue),de=W!=="none",T=g??(Q?Ot(M,m,X):F.index),x=F.index!==-1,P=i(h,l.id),L=i(h,l.isActive,T),K=i(h,l.isSelected,m),$=i(h,l.items),xe=i(h,l.getItemProps),B=t.useRef(null),D=P!=null&&x?`${P}-${T}`:void 0,v=K&&de;ce(()=>{if(!(x&&(Q||g!=null)))return;const A=h.state.listRef.current;return A[T]=B.current,()=>{delete A[T]}},[x,Q,T,g,h]),ce(()=>{if(!x||$)return;const k=h.state.valuesRef.current;return k[T]=m,W!=="none"&&h.state.allValuesRef.current.push(m),()=>{delete k[T]}},[x,$,T,m,h,W]),ce(()=>{if(!y){w.current=!1;return}if(!x||$)return;const k=h.state.selectedValue,A=Array.isArray(k)?k[k.length-1]:k;kt(A,m,X)&&h.set("selectedIndex",T)},[x,$,y,h,T,m,X]);const H=t.useMemo(()=>({disabled:d,selected:v,highlighted:L}),[d,v,L]),fe=xe({active:L,selected:v});fe.id=void 0,fe.onFocus=void 0;const{getButtonProps:Ve,buttonRef:oe}=Io({disabled:d,focusableWhenDisabled:!0,native:o});function re(k){function A(){h.state.handleSelection(k,m)}h.state.submitOnItemClick?(xo.flushSync(A),h.state.requestSubmit()):A()}const z={id:D,role:se?"gridcell":"option","aria-disabled":d||void 0,"aria-selected":de?v:void 0,tabIndex:void 0,onPointerDownCapture(k){w.current=!0,k.preventDefault()},onClick(k){d||n||re(k.nativeEvent)},onMouseUp(k){const A=w.current;w.current=!1,!(d||n||k.button!==0||A||!L)&&re(k.nativeEvent)}},Se=he("div",r,{ref:[oe,p,F.ref,B],state:H,props:[fe,z,R,Ve]}),_e=t.useMemo(()=>({selected:v,textRef:q}),[v,q]);return G.jsx(un.Provider,{value:_e,children:Se})})),Rs=t.forwardRef(function(r,p){const{render:C,className:E,...m}=r,g=he("div",r,{ref:p,props:[{role:"row"},m]});return G.jsx(cn.Provider,{value:!0,children:g})}),Ps=t.forwardRef(function(r,p){const{render:C,className:E,children:m,...g}=r,{filteredItems:d}=Ge(),o=ke(),R=d.length===0?m:null;return he("div",r,{ref:[p,o.state.emptyRef],props:[{children:R,role:"status","aria-live":"polite","aria-atomic":!0},g]})});export{ds as A,gs as C,hs as a,xs as b,Ps as c,ps as d,ys as e,fs as f,Rs as g,ms as h,bs as i,Cs as j,Is as k,ke as l,Ht as m,bo as n,vs as o,Po as p,Eo as q,l as s,Ro as u};
