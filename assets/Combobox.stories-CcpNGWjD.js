import{j as s}from"./jsx-runtime-u17CrQMm.js";import{r}from"./iframe-DEeGeQmx.js";import{I as H}from"./Icon-Du4yfv2t.js";import{u as D,f as Ge,m as h}from"./mergeClassName-BNAeu4iQ.js";import{f as ce,l as E}from"./Listbox.module-CQsTgEeH.js";import{l as $,m as Fe,n as pe,s as c,A as Ke,o as ue,p as Ue,q as We,C as ze,f as He,a as qe,b as Ye,c as Xe,d as Je,e as Qe,g as Ze,h as eo,i as oo,j as to,k as so}from"./ComboboxEmpty-DDg4o2TZ.js";import{u as be,a as no,f as ro}from"./LabelableContext-CaGmJrJF.js";import{u as fe}from"./useTransitionStatus-cB-ptfQy.js";import{u as xe,t as Ce}from"./useOpenChangeComplete-Ph1DesCe.js";import{c as S,l as he,a as de,n as ao,b as me}from"./createBaseUIEventDetails-BeElkf0B.js";import{u as d,p as io,t as lo}from"./popupStateMapping-B9bpgTNS.js";import{u as Y}from"./useButton-BfHs0Tuu.js";import{u as co}from"./useStableCallback-DO7h5Pr5.js";import{u as mo}from"./useTimeout-DA2ibUVR.js";import{o as po}from"./owner-CvMgaIeV.js";import{g as uo}from"./getPseudoElementBounds-L0mGlMFL.js";import{u as bo}from"./useTypeahead-Bbyozqw7.js";import{u as fo}from"./useClick-Dttbq7Hp.js";import{s as O}from"./event-CNRsvx7q.js";import{g as xo,c as q}from"./element-C8qsRkBu.js";import{C as Co,u as ho}from"./useCompositeListItem-BgXMeN-J.js";import{r as go}from"./index-Kut21IzS.js";import{S as Io}from"./Separator-Ck3yMOR6.js";import{F as yo}from"./Field-Dydfz-Ix.js";import"./preload-helper-ClwkVg-s.js";import"./useControlled-BCfLpEop.js";import"./visuallyHidden-CbwUG2x5.js";import"./useValueAsRef-BrOSccPP.js";import"./useLabelableId-BjSFgaTO.js";import"./floating-ui.utils.dom-CWuwp5es.js";import"./useBaseUiId-f2fTMo5O.js";import"./useId-H7dhCfMg.js";import"./InternalBackdrop-BHfnogQf.js";import"./detectBrowser-CYw91I8L.js";import"./useAnimationFrame-DWy1HDF3.js";import"./useOnMount-C_ExCAsE.js";import"./useInteractions-BbDBxniS.js";import"./constants-CNjsXAL1.js";import"./useValueChanged-ClCCtWZS.js";import"./useAnchorPositioning-CjXR7ona.js";import"./floating-ui.utils-CtlI5I81.js";import"./DirectionContext-Bpzfmgnk.js";import"./useListNavigation-B-NMRKNd.js";import"./composite-BpyLfiE4.js";import"./inertValue-BB0nU4Ex.js";import"./getDisabledMountTransitionStyles-MZhtSREL.js";import"./index-DylRyPx3.js";import"./InputBox-DsaFxJon.js";import"./Input-Dp2sXujJ.js";import"./FieldLabel-DLi33uji.js";import"./FieldsetRootContext-C3KMZkvC.js";const K=2,Ro={...io,...ro},_o=r.forwardRef(function(e,t){const{render:N,className:k,nativeButton:_=!0,disabled:m=!1,...l}=e,{state:C,disabled:p,setTouched:i,setFocused:b,validationMode:j,validation:x}=be(),{labelId:A}=no(),a=$(),M=d(a,c.selectionMode),f=d(a,c.disabled),n=d(a,c.readOnly),u=d(a,c.listElement),P=d(a,c.triggerProps),g=d(a,c.triggerElement),y=d(a,c.inputInsidePopup),w=d(a,c.open),W=d(a,c.selectedValue),z=d(a,c.activeIndex),re=d(a,c.selectedIndex),v=Fe(),B=pe(),ke=mo(),T=p||f||m,ae=r.useRef("");function ie(I){ae.current=I.pointerType}const le=v.select("domReferenceElement");r.useEffect(()=>{y&&g&&g!==le&&v.set("domReferenceElement",g)},[g,le,v,y]);const{reference:Se}=bo(v,{enabled:!w&&!n&&!f&&M==="single",listRef:a.state.labelsRef,activeIndex:z,selectedIndex:re,onMatch(I){const L=a.state.valuesRef.current[I];L!==void 0&&a.state.setSelectedValue(L,S("none"))}}),{reference:Ee}=fo(v,{enabled:!n&&!f,event:"mousedown"}),{buttonRef:Ae,getButtonProps:Me}=Y({native:_,disabled:T}),Te=r.useMemo(()=>({...C,open:w,disabled:T}),[C,w,T]),Ve=co(I=>{a.set("triggerElement",I)});return D("button",e,{ref:[t,Ae,Ve],state:Te,props:[P,Ee,Se,{tabIndex:y?0:-1,disabled:T,role:y?"combobox":void 0,"aria-expanded":w?"true":"false","aria-haspopup":y?"dialog":"listbox","aria-controls":w?u?.id:void 0,"aria-readonly":n||void 0,"aria-labelledby":A,onPointerDown:ie,onPointerEnter:ie,onFocus(){b(!0),!(T||n)&&ke.start(0,a.state.forceMount)},onBlur(){if(i(!0),b(!1),j==="onBlur"){const I=M==="none"?B:W;x.commit(I)}},onMouseDown(I){if(T||n||(y||v.set("domReferenceElement",I.currentTarget),a.state.forceMount(),ae.current!=="touch"&&(a.state.inputRef.current?.focus(),y||I.preventDefault()),w))return;const L=po(I.currentTarget);function De(V){if(!g)return;const G=xo(V),Oe=a.state.positionerElement,$e=a.state.listElement;if(q(g,G)||q(Oe,G)||q($e,G)||G===g)return;const F=uo(g),Be=V.clientX>=F.left-K&&V.clientX<=F.right+K,Le=V.clientY>=F.top-K&&V.clientY<=F.bottom+K;Be&&Le||a.state.setOpen(!1,S("cancel-open",V))}y&&L.addEventListener("mouseup",De,{once:!0})},onKeyDown(I){T||n||(I.key==="ArrowDown"||I.key==="ArrowUp")&&(O(I),a.state.setOpen(!0,S(he,I.nativeEvent)),a.state.inputRef.current?.focus())}},x?x.getValidationProps(l):l,Me],stateAttributesMapping:Ro})}),No={...Ce,...lo},wo=r.forwardRef(function(e,t){const{render:N,className:k,disabled:_=!1,nativeButton:m=!0,keepMounted:l=!1,...C}=e,{disabled:p}=be(),i=$(),b=d(i,c.selectionMode),j=d(i,c.disabled),x=d(i,c.readOnly),A=d(i,c.open),a=d(i,c.selectedValue),M=pe();let f=!1;b==="none"?f=M!=="":b==="single"?f=a!=null:f=Array.isArray(a)&&a.length>0;const n=p||j||_,{buttonRef:u,getButtonProps:P}=Y({native:m,disabled:n}),{mounted:g,transitionStatus:y,setMounted:w}=fe(f),W=r.useMemo(()=>({disabled:n,open:A,transitionStatus:y}),[n,A,y]);xe({open:f,ref:i.state.clearRef,onComplete(){f||w(!1)}});const z=D("button",e,{state:W,ref:[t,u,i.state.clearRef],props:[{tabIndex:-1,children:"x",disabled:n,"aria-readonly":x||void 0,onMouseDown(v){v.preventDefault()},onClick(v){if(n||x)return;const B=i.state.keyboardActiveRef;i.state.setInputValue("",S(de,v.nativeEvent)),b!=="none"?(i.state.setSelectedValue(Array.isArray(a)?[]:null,S(de,v.nativeEvent)),i.state.setIndices({activeIndex:null,selectedIndex:null,type:B.current?"keyboard":"pointer"})):i.state.setIndices({activeIndex:null,type:B.current?"keyboard":"pointer"}),i.state.inputRef.current?.focus()}},C,P],stateAttributesMapping:No});return l||g?z:null});function vo(o){const{multiple:e=!1,defaultValue:t,value:N,onValueChange:k,..._}=o;return s.jsx(Ke,{..._,selectionMode:e?"multiple":"single",selectedValue:N,defaultSelectedValue:t,onSelectedValueChange:k})}const jo=r.forwardRef(function(e,t){const N=e.keepMounted??!1,{selected:k}=ue();return N||k?s.jsx(Po,{...e,ref:t}):null}),Po=r.memo(r.forwardRef((o,e)=>{const{render:t,className:N,keepMounted:k,..._}=o,{selected:m}=ue(),l=r.useRef(null),{transitionStatus:C,setMounted:p}=fe(m),i=r.useMemo(()=>({selected:m,transitionStatus:C}),[m,C]),b=D("span",o,{ref:[e,l],state:i,props:[{"aria-hidden":!0,children:"✔️"},_],stateAttributesMapping:Ce});return xe({open:m,ref:l,onComplete(){m||p(!1)}}),b})),ko=r.forwardRef(function(e,t){const{render:N,className:k,..._}=e,m=$(),l=d(m,c.open),[C,p]=r.useState(void 0);l&&C!==void 0&&p(void 0);const i=r.useRef([]),b=D("div",e,{ref:[t,m.state.chipsContainerRef],props:_}),j=r.useMemo(()=>({highlightedChipIndex:C,setHighlightedChipIndex:p,chipsRef:i}),[C,p,i]);return s.jsx(Ue.Provider,{value:j,children:s.jsx(Co,{elementsRef:i,children:b})})}),ge=r.createContext(void 0);function So(){const o=r.useContext(ge);if(!o)throw new Error(Ge(17));return o}const Eo=r.forwardRef(function(e,t){const{render:N,className:k,..._}=e,m=$(),{setHighlightedChipIndex:l,chipsRef:C}=We(),p=d(m,c.disabled),i=d(m,c.readOnly),b=d(m,c.selectedValue),{ref:j,index:x}=ho();function A(n){let u=x;if(n.key==="ArrowLeft")n.preventDefault(),x>0?u=x-1:u=void 0;else if(n.key==="ArrowRight")n.preventDefault(),x<b.length-1?u=x+1:u=void 0;else if(n.key==="Backspace"||n.key==="Delete"){const P=x>=b.length-1?b.length-2:x;u=P>=0?P:void 0,O(n),m.state.setIndices({activeIndex:null,selectedIndex:null,type:"keyboard"}),m.state.setSelectedValue(b.filter((g,y)=>y!==x),S(ao,n.nativeEvent))}else n.key==="Enter"||n.key===" "?(O(n),u=void 0):n.key==="ArrowDown"||n.key==="ArrowUp"?(O(n),m.state.setOpen(!0,S(he,n.nativeEvent)),u=void 0):n.key.length===1&&!n.ctrlKey&&!n.metaKey&&!n.altKey&&(u=void 0);return u}const a=r.useMemo(()=>({disabled:p}),[p]),M=D("div",e,{ref:[t,j],state:a,props:[{tabIndex:-1,"aria-disabled":p||void 0,"aria-readonly":i||void 0,onKeyDown(n){if(p||i)return;const u=A(n);go.flushSync(()=>{l(u)}),u===void 0?m.state.inputRef.current?.focus():C.current[u]?.focus()},onMouseDown(n){p||i||(n.preventDefault(),m.state.inputRef.current?.focus())}},_]}),f=r.useMemo(()=>({index:x}),[x]);return s.jsx(ge.Provider,{value:f,children:M})}),Ao=r.forwardRef(function(e,t){const{render:N,className:k,nativeButton:_=!0,...m}=e,l=$(),{index:C}=So(),p=d(l,c.disabled),i=d(l,c.readOnly),b=d(l,c.selectedValue),j=d(l,c.isItemEqualToValue),{buttonRef:x,getButtonProps:A}=Y({native:_,disabled:p||i,focusableWhenDisabled:!0}),a=r.useMemo(()=>({disabled:p}),[p]);return D("button",e,{ref:[t,x],state:a,props:[{tabIndex:-1,disabled:p,"aria-readonly":i||void 0,onClick(f){if(p||i)return;const n=S(me,f.nativeEvent),u=l.state.activeIndex,P=b[C],g=ce(l.state.valuesRef.current,P,j);g!==-1&&u===g&&l.state.setIndices({activeIndex:null,type:l.state.keyboardActiveRef.current?"pointer":"keyboard"}),l.state.setSelectedValue(b.filter((y,w)=>w!==C),n),n.isPropagationAllowed||f.stopPropagation(),l.state.inputRef.current?.focus()},onKeyDown(f){if(p||i)return;const n=S(me,f.nativeEvent);if(f.key==="Enter"||f.key===" "){const u=l.state.activeIndex,P=b[C],g=ce(l.state.valuesRef.current,P,j);g!==-1&&u===g&&l.state.setIndices({activeIndex:null,type:l.state.keyboardActiveRef.current?"pointer":"keyboard"}),l.state.setSelectedValue(b.filter((y,w)=>w!==C),n),n.isPropagationAllowed||O(f),l.state.inputRef.current?.focus()}}},m,A]})}),Mo="_InputWrapper_1mb86_1",To="_Input_1mb86_1",Vo="_ActionButtons_1mb86_43",Do="_Trigger_1mb86_53",Oo="_Clear_1mb86_54",$o="_Chips_1mb86_81",Bo="_Chip_1mb86_81",Lo="_ChipRemove_1mb86_112",Go="_Positioner_1mb86_132",Fo="_Popup_1mb86_137",Ko="_Row_1mb86_144",Uo="_Item_1mb86_149",Wo="_ItemIndicator_1mb86_162",zo="_ItemText_1mb86_171",Ho="_Arrow_1mb86_179",R={InputWrapper:Mo,Input:To,ActionButtons:Vo,Trigger:Do,Clear:Oo,Chips:$o,Chip:Bo,ChipRemove:Lo,Positioner:Go,Popup:Fo,Row:Ko,Item:Uo,ItemIndicator:Wo,ItemText:zo,Arrow:Ho},qo=vo,Yo=ze,X=r.forwardRef(({className:o,...e},t)=>s.jsx(He,{ref:t,className:h(o,R.Input),...e}));X.displayName="ComboboxInput";const J=r.forwardRef(({className:o,...e},t)=>s.jsx(_o,{ref:t,className:h(o,R.Trigger),...e}));J.displayName="ComboboxTrigger";const Q=r.forwardRef(({className:o,...e},t)=>s.jsx(wo,{ref:t,className:h(o,R.Clear),...e}));Q.displayName="ComboboxClear";const Ie=r.forwardRef(({className:o,...e},t)=>s.jsx(ko,{ref:t,className:h(o,R.Chips),...e}));Ie.displayName="ComboboxChips";const ye=r.forwardRef(({className:o,...e},t)=>s.jsx(Eo,{ref:t,className:h(o,R.Chip),...e}));ye.displayName="ComboboxChip";const Re=r.forwardRef(({className:o,...e},t)=>s.jsx(Ao,{ref:t,className:h(o,R.ChipRemove),...e}));Re.displayName="ComboboxChipRemove";const Z=r.forwardRef(({className:o,...e},t)=>s.jsx(qe,{ref:t,className:h(o,E.Positioner,R.Positioner),...e}));Z.displayName="ComboboxPositioner";const ee=r.forwardRef(({className:o,...e},t)=>s.jsx(Ye,{ref:t,className:h(o,E.Popup,R.Popup),...e}));ee.displayName="ComboboxPopup";const oe=r.forwardRef(({className:o,...e},t)=>s.jsx(Je,{ref:t,className:h(o,E.List),...e}));oe.displayName="ComboboxList";const _e=r.forwardRef(({className:o,...e},t)=>s.jsx(Ze,{ref:t,className:h(o,R.Row),...e}));_e.displayName="ComboboxRow";const te=r.forwardRef(({className:o,...e},t)=>s.jsx(Qe,{ref:t,className:h(o,E.Item,R.Item),...e}));te.displayName="ComboboxItem";const se=r.forwardRef(({className:o,...e},t)=>s.jsx(jo,{ref:t,className:h(o,R.ItemIndicator),...e}));se.displayName="ComboboxItemIndicator";const Ne=r.forwardRef(({className:o,...e},t)=>s.jsx(eo,{ref:t,className:h(o,E.Status),...e}));Ne.displayName="ComboboxStatus";const ne=r.forwardRef(({className:o,...e},t)=>s.jsx(Xe,{ref:t,className:h(o,E.Empty),...e}));ne.displayName="ComboboxEmpty";const we=r.forwardRef(({className:o,...e},t)=>s.jsx(oo,{ref:t,className:h(o,E.Group),...e}));we.displayName="ComboboxGroup";const ve=r.forwardRef(({className:o,...e},t)=>s.jsx(to,{ref:t,className:h(o,E.GroupLabel),...e}));ve.displayName="ComboboxGroupLabel";const je=r.forwardRef(({className:o,...e},t)=>s.jsx(Io,{ref:t,className:h(o,E.Separator),...e}));je.displayName="ComboboxSeparator";const Pe=r.forwardRef(({className:o,...e},t)=>s.jsx(so,{ref:t,className:h(o,R.Arrow),...e}));Pe.displayName="ComboboxArrow";X.__docgenInfo={description:"",methods:[],displayName:"ComboboxInput"};J.__docgenInfo={description:"",methods:[],displayName:"ComboboxTrigger"};Q.__docgenInfo={description:"",methods:[],displayName:"ComboboxClear"};Ie.__docgenInfo={description:"",methods:[],displayName:"ComboboxChips"};ye.__docgenInfo={description:"",methods:[],displayName:"ComboboxChip"};Re.__docgenInfo={description:"",methods:[],displayName:"ComboboxChipRemove"};Z.__docgenInfo={description:"",methods:[],displayName:"ComboboxPositioner"};ee.__docgenInfo={description:"",methods:[],displayName:"ComboboxPopup"};oe.__docgenInfo={description:"",methods:[],displayName:"ComboboxList"};_e.__docgenInfo={description:"",methods:[],displayName:"ComboboxRow"};te.__docgenInfo={description:"",methods:[],displayName:"ComboboxItem"};se.__docgenInfo={description:"",methods:[],displayName:"ComboboxItemIndicator"};Ne.__docgenInfo={description:"",methods:[],displayName:"ComboboxStatus"};ne.__docgenInfo={description:"",methods:[],displayName:"ComboboxEmpty"};we.__docgenInfo={description:"",methods:[],displayName:"ComboboxGroup"};ve.__docgenInfo={description:"",methods:[],displayName:"ComboboxGroupLabel"};je.__docgenInfo={description:"",methods:[],displayName:"ComboboxSeparator"};Pe.__docgenInfo={description:"",methods:[],displayName:"ComboboxArrow"};const Xt={title:"Components/Combobox",decorators:[o=>s.jsx("div",{style:{width:640},children:s.jsx(o,{})})]},Xo=["Tokyo","Osaka","Sapporo","Nagoya","Fukuoka","Sendai","Kobe","Hiroshima","Niigata","Naha"],Jo=()=>{const[o,e]=r.useState(null),t=r.useId();return s.jsxs(qo,{items:Xo,value:o,onValueChange:e,defaultOpen:!0,children:[s.jsx(yo,{label:"都市名",children:s.jsxs("div",{className:R.InputWrapper,children:[s.jsx(X,{id:t,placeholder:"例: Tokyo"}),s.jsxs("div",{className:R.ActionButtons,children:[s.jsx(Q,{"aria-label":"選択をクリア",children:s.jsx(H,{name:"x",size:20})}),s.jsx(J,{"aria-label":"候補を開く",children:s.jsx(H,{name:"caret-down",size:20})})]})]})}),s.jsx(Yo,{children:s.jsx(Z,{sideOffset:8,children:s.jsxs(ee,{children:[s.jsx(ne,{children:"該当する都市がありません。"}),s.jsx(oe,{children:N=>s.jsxs(te,{value:N,children:[s.jsx(se,{children:s.jsx(H,{name:"check",size:20})}),s.jsx("span",{className:R.ItemText,children:N})]},N)})]})})})]})},U={render:()=>s.jsx(Jo,{})};U.parameters={...U.parameters,docs:{...U.parameters?.docs,source:{originalSource:`{
  render: () => <DefaultStory />
}`,...U.parameters?.docs?.source}}};const Jt=["Default"];export{U as Default,Jt as __namedExportsOrder,Xt as default};
