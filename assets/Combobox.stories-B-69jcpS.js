import{j as s}from"./jsx-runtime-u17CrQMm.js";import{r}from"./iframe-DCTwtVEg.js";import{I as H}from"./createReactComponent-BVoNDKa1.js";import{u as D,f as Ge,m as h}from"./mergeClassName-CGuaxy8D.js";import{f as le,l as E}from"./Listbox.module-DjVxaMRC.js";import{l as $,m as Fe,n as pe,s as l,A as Ke,o as ue,p as Ue,q as We,C as ze,f as He,a as qe,b as Xe,c as Ye,d as Je,e as Qe,g as Ze,h as eo,i as oo,j as to,k as so}from"./ComboboxEmpty-DD6niAih.js";import{u as be,a as no,f as ro}from"./LabelableContext-Bcab7PGA.js";import{u as fe}from"./useTransitionStatus-BGkF8oIU.js";import{u as xe,t as Ce}from"./useOpenChangeComplete-CAiTarFg.js";import{c as S,l as he,a as de,n as ao,b as me}from"./createBaseUIEventDetails-BDhVKG5E.js";import{u as d,p as io,t as co}from"./popupStateMapping-D9WKduT9.js";import{u as X}from"./useButton-BBNhskDs.js";import{u as lo}from"./useStableCallback-BlvU505D.js";import{u as mo}from"./useTimeout-D67vsree.js";import{o as po}from"./owner-CvMgaIeV.js";import{g as uo}from"./getPseudoElementBounds-L0mGlMFL.js";import{u as bo}from"./useTypeahead-j2PqVkU7.js";import{u as fo}from"./useClick-jhZSDhhO.js";import{s as O}from"./event-CNRsvx7q.js";import{g as xo,c as q}from"./element-C8qsRkBu.js";import{C as Co,u as ho}from"./useCompositeListItem-DQGumxn-.js";import{r as Io}from"./index-zOVaSaDz.js";import{S as go}from"./Separator-BeOlmKtI.js";import{F as yo}from"./Field-C9KvvZpz.js";import{I as Ro}from"./IconX-DtYP0ntd.js";import{I as _o}from"./IconCaretDown-F7xRRqTf.js";import{I as No}from"./IconCheck-Dqggjh8y.js";import"./preload-helper-ClwkVg-s.js";import"./useRender-BavQ6iTs.js";import"./useControlled-C-9u02Ss.js";import"./visuallyHidden-CbwUG2x5.js";import"./useValueAsRef-BBKeM-2h.js";import"./useLabelableId-CPEzFwi8.js";import"./floating-ui.utils.dom-CWuwp5es.js";import"./useBaseUiId-DBEJHERS.js";import"./useId-DhseFPV0.js";import"./InternalBackdrop-Dm5KPtnK.js";import"./detectBrowser-CYw91I8L.js";import"./useAnimationFrame-DjvyS4jC.js";import"./useOnMount-CchHJru6.js";import"./useInteractions-DGgngZ7b.js";import"./constants-CNjsXAL1.js";import"./useValueChanged-DWOD2Xr9.js";import"./useAnchorPositioning-z85Juv3n.js";import"./floating-ui.utils-CtlI5I81.js";import"./DirectionContext-gps4P05p.js";import"./useListNavigation-CQ0tcvfh.js";import"./composite-BpyLfiE4.js";import"./inertValue-B7yfhbfC.js";import"./getDisabledMountTransitionStyles-CjB8mk2n.js";import"./index-DT-vH3A5.js";import"./InputBox-Ru6ROqUF.js";import"./Input-sNEoF7L9.js";import"./FieldLabel-DMN6kjzS.js";import"./FieldsetRootContext-DmNMPa73.js";const K=2,wo={...io,...ro},vo=r.forwardRef(function(e,t){const{render:N,className:k,nativeButton:_=!0,disabled:m=!1,...c}=e,{state:C,disabled:p,setTouched:i,setFocused:b,validationMode:j,validation:x}=be(),{labelId:A}=no(),a=$(),M=d(a,l.selectionMode),f=d(a,l.disabled),n=d(a,l.readOnly),u=d(a,l.listElement),P=d(a,l.triggerProps),I=d(a,l.triggerElement),y=d(a,l.inputInsidePopup),w=d(a,l.open),W=d(a,l.selectedValue),z=d(a,l.activeIndex),re=d(a,l.selectedIndex),v=Fe(),B=pe(),ke=mo(),T=p||f||m,ae=r.useRef("");function ie(g){ae.current=g.pointerType}const ce=v.select("domReferenceElement");r.useEffect(()=>{y&&I&&I!==ce&&v.set("domReferenceElement",I)},[I,ce,v,y]);const{reference:Se}=bo(v,{enabled:!w&&!n&&!f&&M==="single",listRef:a.state.labelsRef,activeIndex:z,selectedIndex:re,onMatch(g){const L=a.state.valuesRef.current[g];L!==void 0&&a.state.setSelectedValue(L,S("none"))}}),{reference:Ee}=fo(v,{enabled:!n&&!f,event:"mousedown"}),{buttonRef:Ae,getButtonProps:Me}=X({native:_,disabled:T}),Te=r.useMemo(()=>({...C,open:w,disabled:T}),[C,w,T]),Ve=lo(g=>{a.set("triggerElement",g)});return D("button",e,{ref:[t,Ae,Ve],state:Te,props:[P,Ee,Se,{tabIndex:y?0:-1,disabled:T,role:y?"combobox":void 0,"aria-expanded":w?"true":"false","aria-haspopup":y?"dialog":"listbox","aria-controls":w?u?.id:void 0,"aria-readonly":n||void 0,"aria-labelledby":A,onPointerDown:ie,onPointerEnter:ie,onFocus(){b(!0),!(T||n)&&ke.start(0,a.state.forceMount)},onBlur(){if(i(!0),b(!1),j==="onBlur"){const g=M==="none"?B:W;x.commit(g)}},onMouseDown(g){if(T||n||(y||v.set("domReferenceElement",g.currentTarget),a.state.forceMount(),ae.current!=="touch"&&(a.state.inputRef.current?.focus(),y||g.preventDefault()),w))return;const L=po(g.currentTarget);function De(V){if(!I)return;const G=xo(V),Oe=a.state.positionerElement,$e=a.state.listElement;if(q(I,G)||q(Oe,G)||q($e,G)||G===I)return;const F=uo(I),Be=V.clientX>=F.left-K&&V.clientX<=F.right+K,Le=V.clientY>=F.top-K&&V.clientY<=F.bottom+K;Be&&Le||a.state.setOpen(!1,S("cancel-open",V))}y&&L.addEventListener("mouseup",De,{once:!0})},onKeyDown(g){T||n||(g.key==="ArrowDown"||g.key==="ArrowUp")&&(O(g),a.state.setOpen(!0,S(he,g.nativeEvent)),a.state.inputRef.current?.focus())}},x?x.getValidationProps(c):c,Me],stateAttributesMapping:wo})}),jo={...Ce,...co},Po=r.forwardRef(function(e,t){const{render:N,className:k,disabled:_=!1,nativeButton:m=!0,keepMounted:c=!1,...C}=e,{disabled:p}=be(),i=$(),b=d(i,l.selectionMode),j=d(i,l.disabled),x=d(i,l.readOnly),A=d(i,l.open),a=d(i,l.selectedValue),M=pe();let f=!1;b==="none"?f=M!=="":b==="single"?f=a!=null:f=Array.isArray(a)&&a.length>0;const n=p||j||_,{buttonRef:u,getButtonProps:P}=X({native:m,disabled:n}),{mounted:I,transitionStatus:y,setMounted:w}=fe(f),W=r.useMemo(()=>({disabled:n,open:A,transitionStatus:y}),[n,A,y]);xe({open:f,ref:i.state.clearRef,onComplete(){f||w(!1)}});const z=D("button",e,{state:W,ref:[t,u,i.state.clearRef],props:[{tabIndex:-1,children:"x",disabled:n,"aria-readonly":x||void 0,onMouseDown(v){v.preventDefault()},onClick(v){if(n||x)return;const B=i.state.keyboardActiveRef;i.state.setInputValue("",S(de,v.nativeEvent)),b!=="none"?(i.state.setSelectedValue(Array.isArray(a)?[]:null,S(de,v.nativeEvent)),i.state.setIndices({activeIndex:null,selectedIndex:null,type:B.current?"keyboard":"pointer"})):i.state.setIndices({activeIndex:null,type:B.current?"keyboard":"pointer"}),i.state.inputRef.current?.focus()}},C,P],stateAttributesMapping:jo});return c||I?z:null});function ko(o){const{multiple:e=!1,defaultValue:t,value:N,onValueChange:k,..._}=o;return s.jsx(Ke,{..._,selectionMode:e?"multiple":"single",selectedValue:N,defaultSelectedValue:t,onSelectedValueChange:k})}const So=r.forwardRef(function(e,t){const N=e.keepMounted??!1,{selected:k}=ue();return N||k?s.jsx(Eo,{...e,ref:t}):null}),Eo=r.memo(r.forwardRef((o,e)=>{const{render:t,className:N,keepMounted:k,..._}=o,{selected:m}=ue(),c=r.useRef(null),{transitionStatus:C,setMounted:p}=fe(m),i=r.useMemo(()=>({selected:m,transitionStatus:C}),[m,C]),b=D("span",o,{ref:[e,c],state:i,props:[{"aria-hidden":!0,children:"✔️"},_],stateAttributesMapping:Ce});return xe({open:m,ref:c,onComplete(){m||p(!1)}}),b})),Ao=r.forwardRef(function(e,t){const{render:N,className:k,..._}=e,m=$(),c=d(m,l.open),[C,p]=r.useState(void 0);c&&C!==void 0&&p(void 0);const i=r.useRef([]),b=D("div",e,{ref:[t,m.state.chipsContainerRef],props:_}),j=r.useMemo(()=>({highlightedChipIndex:C,setHighlightedChipIndex:p,chipsRef:i}),[C,p,i]);return s.jsx(Ue.Provider,{value:j,children:s.jsx(Co,{elementsRef:i,children:b})})}),Ie=r.createContext(void 0);function Mo(){const o=r.useContext(Ie);if(!o)throw new Error(Ge(17));return o}const To=r.forwardRef(function(e,t){const{render:N,className:k,..._}=e,m=$(),{setHighlightedChipIndex:c,chipsRef:C}=We(),p=d(m,l.disabled),i=d(m,l.readOnly),b=d(m,l.selectedValue),{ref:j,index:x}=ho();function A(n){let u=x;if(n.key==="ArrowLeft")n.preventDefault(),x>0?u=x-1:u=void 0;else if(n.key==="ArrowRight")n.preventDefault(),x<b.length-1?u=x+1:u=void 0;else if(n.key==="Backspace"||n.key==="Delete"){const P=x>=b.length-1?b.length-2:x;u=P>=0?P:void 0,O(n),m.state.setIndices({activeIndex:null,selectedIndex:null,type:"keyboard"}),m.state.setSelectedValue(b.filter((I,y)=>y!==x),S(ao,n.nativeEvent))}else n.key==="Enter"||n.key===" "?(O(n),u=void 0):n.key==="ArrowDown"||n.key==="ArrowUp"?(O(n),m.state.setOpen(!0,S(he,n.nativeEvent)),u=void 0):n.key.length===1&&!n.ctrlKey&&!n.metaKey&&!n.altKey&&(u=void 0);return u}const a=r.useMemo(()=>({disabled:p}),[p]),M=D("div",e,{ref:[t,j],state:a,props:[{tabIndex:-1,"aria-disabled":p||void 0,"aria-readonly":i||void 0,onKeyDown(n){if(p||i)return;const u=A(n);Io.flushSync(()=>{c(u)}),u===void 0?m.state.inputRef.current?.focus():C.current[u]?.focus()},onMouseDown(n){p||i||(n.preventDefault(),m.state.inputRef.current?.focus())}},_]}),f=r.useMemo(()=>({index:x}),[x]);return s.jsx(Ie.Provider,{value:f,children:M})}),Vo=r.forwardRef(function(e,t){const{render:N,className:k,nativeButton:_=!0,...m}=e,c=$(),{index:C}=Mo(),p=d(c,l.disabled),i=d(c,l.readOnly),b=d(c,l.selectedValue),j=d(c,l.isItemEqualToValue),{buttonRef:x,getButtonProps:A}=X({native:_,disabled:p||i,focusableWhenDisabled:!0}),a=r.useMemo(()=>({disabled:p}),[p]);return D("button",e,{ref:[t,x],state:a,props:[{tabIndex:-1,disabled:p,"aria-readonly":i||void 0,onClick(f){if(p||i)return;const n=S(me,f.nativeEvent),u=c.state.activeIndex,P=b[C],I=le(c.state.valuesRef.current,P,j);I!==-1&&u===I&&c.state.setIndices({activeIndex:null,type:c.state.keyboardActiveRef.current?"pointer":"keyboard"}),c.state.setSelectedValue(b.filter((y,w)=>w!==C),n),n.isPropagationAllowed||f.stopPropagation(),c.state.inputRef.current?.focus()},onKeyDown(f){if(p||i)return;const n=S(me,f.nativeEvent);if(f.key==="Enter"||f.key===" "){const u=c.state.activeIndex,P=b[C],I=le(c.state.valuesRef.current,P,j);I!==-1&&u===I&&c.state.setIndices({activeIndex:null,type:c.state.keyboardActiveRef.current?"pointer":"keyboard"}),c.state.setSelectedValue(b.filter((y,w)=>w!==C),n),n.isPropagationAllowed||O(f),c.state.inputRef.current?.focus()}}},m,A]})}),Do="_InputWrapper_1mb86_1",Oo="_Input_1mb86_1",$o="_ActionButtons_1mb86_43",Bo="_Trigger_1mb86_53",Lo="_Clear_1mb86_54",Go="_Chips_1mb86_81",Fo="_Chip_1mb86_81",Ko="_ChipRemove_1mb86_112",Uo="_Positioner_1mb86_132",Wo="_Popup_1mb86_137",zo="_Row_1mb86_144",Ho="_Item_1mb86_149",qo="_ItemIndicator_1mb86_162",Xo="_ItemText_1mb86_171",Yo="_Arrow_1mb86_179",R={InputWrapper:Do,Input:Oo,ActionButtons:$o,Trigger:Bo,Clear:Lo,Chips:Go,Chip:Fo,ChipRemove:Ko,Positioner:Uo,Popup:Wo,Row:zo,Item:Ho,ItemIndicator:qo,ItemText:Xo,Arrow:Yo},Jo=ko,Qo=ze,Y=r.forwardRef(({className:o,...e},t)=>s.jsx(He,{ref:t,className:h(o,R.Input),...e}));Y.displayName="ComboboxInput";const J=r.forwardRef(({className:o,...e},t)=>s.jsx(vo,{ref:t,className:h(o,R.Trigger),...e}));J.displayName="ComboboxTrigger";const Q=r.forwardRef(({className:o,...e},t)=>s.jsx(Po,{ref:t,className:h(o,R.Clear),...e}));Q.displayName="ComboboxClear";const ge=r.forwardRef(({className:o,...e},t)=>s.jsx(Ao,{ref:t,className:h(o,R.Chips),...e}));ge.displayName="ComboboxChips";const ye=r.forwardRef(({className:o,...e},t)=>s.jsx(To,{ref:t,className:h(o,R.Chip),...e}));ye.displayName="ComboboxChip";const Re=r.forwardRef(({className:o,...e},t)=>s.jsx(Vo,{ref:t,className:h(o,R.ChipRemove),...e}));Re.displayName="ComboboxChipRemove";const Z=r.forwardRef(({className:o,...e},t)=>s.jsx(qe,{ref:t,className:h(o,E.Positioner,R.Positioner),...e}));Z.displayName="ComboboxPositioner";const ee=r.forwardRef(({className:o,...e},t)=>s.jsx(Xe,{ref:t,className:h(o,E.Popup,R.Popup),...e}));ee.displayName="ComboboxPopup";const oe=r.forwardRef(({className:o,...e},t)=>s.jsx(Je,{ref:t,className:h(o,E.List),...e}));oe.displayName="ComboboxList";const _e=r.forwardRef(({className:o,...e},t)=>s.jsx(Ze,{ref:t,className:h(o,R.Row),...e}));_e.displayName="ComboboxRow";const te=r.forwardRef(({className:o,...e},t)=>s.jsx(Qe,{ref:t,className:h(o,E.Item,R.Item),...e}));te.displayName="ComboboxItem";const se=r.forwardRef(({className:o,...e},t)=>s.jsx(So,{ref:t,className:h(o,R.ItemIndicator),...e}));se.displayName="ComboboxItemIndicator";const Ne=r.forwardRef(({className:o,...e},t)=>s.jsx(eo,{ref:t,className:h(o,E.Status),...e}));Ne.displayName="ComboboxStatus";const ne=r.forwardRef(({className:o,...e},t)=>s.jsx(Ye,{ref:t,className:h(o,E.Empty),...e}));ne.displayName="ComboboxEmpty";const we=r.forwardRef(({className:o,...e},t)=>s.jsx(oo,{ref:t,className:h(o,E.Group),...e}));we.displayName="ComboboxGroup";const ve=r.forwardRef(({className:o,...e},t)=>s.jsx(to,{ref:t,className:h(o,E.GroupLabel),...e}));ve.displayName="ComboboxGroupLabel";const je=r.forwardRef(({className:o,...e},t)=>s.jsx(go,{ref:t,className:h(o,E.Separator),...e}));je.displayName="ComboboxSeparator";const Pe=r.forwardRef(({className:o,...e},t)=>s.jsx(so,{ref:t,className:h(o,R.Arrow),...e}));Pe.displayName="ComboboxArrow";Y.__docgenInfo={description:"",methods:[],displayName:"ComboboxInput"};J.__docgenInfo={description:"",methods:[],displayName:"ComboboxTrigger"};Q.__docgenInfo={description:"",methods:[],displayName:"ComboboxClear"};ge.__docgenInfo={description:"",methods:[],displayName:"ComboboxChips"};ye.__docgenInfo={description:"",methods:[],displayName:"ComboboxChip"};Re.__docgenInfo={description:"",methods:[],displayName:"ComboboxChipRemove"};Z.__docgenInfo={description:"",methods:[],displayName:"ComboboxPositioner"};ee.__docgenInfo={description:"",methods:[],displayName:"ComboboxPopup"};oe.__docgenInfo={description:"",methods:[],displayName:"ComboboxList"};_e.__docgenInfo={description:"",methods:[],displayName:"ComboboxRow"};te.__docgenInfo={description:"",methods:[],displayName:"ComboboxItem"};se.__docgenInfo={description:"",methods:[],displayName:"ComboboxItemIndicator"};Ne.__docgenInfo={description:"",methods:[],displayName:"ComboboxStatus"};ne.__docgenInfo={description:"",methods:[],displayName:"ComboboxEmpty"};we.__docgenInfo={description:"",methods:[],displayName:"ComboboxGroup"};ve.__docgenInfo={description:"",methods:[],displayName:"ComboboxGroupLabel"};je.__docgenInfo={description:"",methods:[],displayName:"ComboboxSeparator"};Pe.__docgenInfo={description:"",methods:[],displayName:"ComboboxArrow"};const ss={title:"Components/Combobox",decorators:[o=>s.jsx("div",{style:{width:640},children:s.jsx(o,{})})]},Zo=["Tokyo","Osaka","Sapporo","Nagoya","Fukuoka","Sendai","Kobe","Hiroshima","Niigata","Naha"],et=()=>{const[o,e]=r.useState(null),t=r.useId();return s.jsxs(Jo,{items:Zo,value:o,onValueChange:e,defaultOpen:!0,children:[s.jsx(yo,{label:"都市名",children:s.jsxs("div",{className:R.InputWrapper,children:[s.jsx(Y,{id:t,placeholder:"例: Tokyo"}),s.jsxs("div",{className:R.ActionButtons,children:[s.jsx(Q,{"aria-label":"選択をクリア",children:s.jsx(H,{icon:Ro,size:20})}),s.jsx(J,{"aria-label":"候補を開く",children:s.jsx(H,{icon:_o,size:20})})]})]})}),s.jsx(Qo,{children:s.jsx(Z,{sideOffset:8,children:s.jsxs(ee,{children:[s.jsx(ne,{children:"該当する都市がありません。"}),s.jsx(oe,{children:N=>s.jsxs(te,{value:N,children:[s.jsx(se,{children:s.jsx(H,{icon:No,size:20})}),s.jsx("span",{className:R.ItemText,children:N})]},N)})]})})})]})},U={render:()=>s.jsx(et,{})};U.parameters={...U.parameters,docs:{...U.parameters?.docs,source:{originalSource:`{
  render: () => <DefaultStory />
}`,...U.parameters?.docs?.source}}};const ns=["Default"];export{U as Default,ns as __namedExportsOrder,ss as default};
